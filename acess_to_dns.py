import nmap
import socket
from tabulate import tabulate

ip_list = ["10.101.148.87","10.101.148.209","10.101.148.203","10.101.148.209","10.101.148.203","10.101.148.203","10.101.151.5","10.101.151.5","10.101.151.5","10.101.151.5","10.101.148.178","10.101.148.178","10.101.151.5","10.101.148.178","10.101.148.178","10.101.151.5","10.101.148.178","10.101.151.2","10.101.151.2","10.101.149.43","10.101.149.43","10.101.151.2","10.101.149.43","10.101.149.43","10.101.151.2","10.101.149.43","10.101.148.127","10.101.148.127","10.101.148.127","10.101.149.157","10.101.149.157","10.101.149.157","10.101.149.157","10.101.148.127","10.101.148.127","10.101.148.127","10.101.149.157","10.101.149.157","10.101.149.157","10.101.149.157","10.101.148.86","10.101.148.86","10.101.148.88","10.101.148.88","10.101.148.214","10.101.148.214","10.101.148.214","10.101.148.214","10.101.148.224","10.101.148.224","10.101.148.224","10.101.148.224","10.101.148.86","10.101.148.88","10.101.148.88","10.101.148.86","10.101.148.214","10.101.148.224","10.101.148.88","10.101.148.88","10.101.148.224","10.101.148.214","10.101.148.214","10.101.148.87","10.101.148.87","10.101.148.87","10.101.149.94","10.101.149.94","10.101.148.87","10.101.149.94","10.101.149.94","10.101.149.94","10.101.148.209","10.101.148.209","10.101.148.209","10.101.148.209","10.101.148.209","10.101.148.209","10.101.148.209","10.101.149.62","10.101.149.62","10.101.148.203","10.101.148.203","10.101.149.62","10.101.148.203","10.101.148.203","10.101.149.62","10.101.148.203","10.101.148.203","10.101.151.5","10.101.151.5","10.101.148.178","10.101.148.178","10.101.149.43","10.101.149.43","10.101.149.43","10.101.149.43","10.101.151.5","10.101.148.178","10.101.151.2"]

dns_solves = {}
for ip in ip_list:

    try:
        dns_name = socket.gethostbyaddr(ip)[0]
    except socket.herror:
        dns_name = "N/A"  # DNS lookup failed
    dns_solves[ip] = dns_name

for ip in dns_solves.keys():
    print(f"{ip} : {dns_solves[ip]}")